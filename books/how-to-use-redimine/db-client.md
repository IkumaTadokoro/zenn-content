---
title: 'DBクライアント'
---

## データベースツールウィンドウ

本ChapterではRailsでの開発に役立つ、RubyMineのデータベースツールを紹介します。

RubyMineには複数のツールウィンドウがありますが、画面右側の「Database」タブを選択することで、データベースツールウィンドウを開くことができます。

データベースツールウィンドウは独立したDBクライアントであるため、接続情報さえ登録すれば開発しているアプリに関係ないDBを操作することもできますが、今回はRailsアプリに紐づくDBを操作する方法を記載します。

![](/images/db-client/rubymine-210820-10:31:52.png)

## DB接続の登録

データベースをオープンするためには、接続情報を登録する必要があります。

Databaseツールウィンドウ > + > DataSource から使用するDBを選択して、接続情報を登録することもできますが、ここではRailsで作成されたデータベースファイルを使用します。

![](/images/db-client/rubymine-210820-10:33:46.png)

マイグレーションを実施した際に`app/db`ディレクトリに作成されたデータベースファイルを開くことで、DB接続が完了します。
sqlite3を利用しているのであれば、`development.sqlite3`を開くことで、接続情報が登録され、データベースツールウィンドウと、DBを操作するためのコンソールが開きます。

![](/images/db-client/rubymine-210820-10:36:33.png)

## オブジェクトの参照

データベースツールウィンドウでは、接続したDBに登録されているオブジェクトがツリー構造で表示されています。
tables > テーブル一覧 > columns > そのテーブルのカラム一覧 という形で順をおって確認することができます。

![](/images/db-client/rubymine-210820-10:55:13.png)

テーブルを選択して開くことで、エディタ上にそのテーブルに登録されているレコードが表示されます。
エディタ上に表示されたデータはスプレッドシートのように、直接編集することができます（登録・更新・削除が可能です）。

基本的にはデータを直接編集することは望ましくないですが、動作確認用にちょっとしたテストデータを作成する際には重宝します。

![](/images/db-client/how-to-show-data-grid.gif)

またテーブルを選択し、`F1`を入力することで、QuickDefinitionをプレビューすることができます。 選択しているテーブルのDDLと最初の数件のデータを参照することができます。

![](/images/db-client/how-to-show-quick-definition.gif)

## クエリの実行（コンソール）

Jump to Query Console...（`⌘` + `Shift` + `F10`）を選択することで、クエリコンソールを開くことができます。

![](/images/db-client/how-to-open-query-console.gif)

クエリコンソールはその名の通り、接続中のDBに対してSQLでクエリを発行するためのコンソールです。
直接SQLを記述し、Execute（`⌘` + `Enter`）を選択することで、クエリの実行結果を確認することができます。

クエリを入力する際にも、ライブテンプレート（`⌘` + `J`）とインテリセンス（`⌃` + `Space`）を利用することができます。
特にインテリセンスについては、表別名から列名を取得することができるので便利です。

![](/images/db-client/how-to-use-complete-at-query-console.gif)

## ダイアグラムの表示

ER図とまではいかないですが、対象のDBに登録されているテーブル一覧とその関係性を表示してくれます。

![](/images/db-client/rubymine-210820-11:18:48.png)

データベースツールウィンドウから、tablesを右クリックし、コンテキストメニュー > Diagrams > Show Visualization... > Database Schema Diagram を選択することで、そのスキーマに存在するテーブルの関係図を表示することができます。

![](/images/db-client/how-to-use-diagrams.gif)

テーブルの関係性をさっと一覧したい時に便利です。

## その他の機能

他にもDDLを自動作成する、テーブル定義を変更する、TRUNCATEを実行する...といった機能がありますが、ActiveRecordというORMを介している以上、あまりDBを直接操作するのはおすすめできません。

本Chapterで紹介した機能で大部分は賄えると思いますが、その他の機能も気になる方は以下を読んでもらえると理解が深まると思います。

[データベースツールおよび SQL \| RubyMine](https://pleiades.io/help/ruby/relational-databases.html)
